<ui:composition xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    
    <h:head>
        <title>Bloqueio de Serviços</title>
        <meta http-equiv="X-UA-Compatible" content="IE=9" />
    </h:head>
    <h:body class="divMenu">
        <f:subview id="header">
            <ui:include src="template.xhtml"/>
            <ui:include src="templateLinks.xhtml"/>
        </f:subview>
        <f:view>
            <h:form id="formBloqueioServicos">
                <c:set scope="request" var="object" value="${bloqueioServicosBean.bloqueia}"/>
                <center>
                    <div class="headerPanel">
                        <h:outputText value="Bloqueio de Serviços" styleClass="fontePanel" style="width: 100%;"/>
                    </div>
                    <br /><br />
                    <div class="divMae">
                        <div class="divFundo">
                            <h:panelGrid columns="4" style="float: left">
                                <h:commandButton image="/Imagens/pesquisar.png" action="#{chamadaPaginaBean.pesquisaPessoa}"/>
                                <h:outputLabel value="Pesquisa Pessoa: " styleClass="fontePadrao" />
                                <h:outputText id="i_nome" value="#{bloqueioServicosBean.pessoa.nome}" title="#{bloqueioServicosBean.pessoa.nome}" styleClass="negritoDescricao" style="overflow-x: hidden"/>
                                <a4j:commandButton id="b_remover" image="/Imagens/excluirp.png" action="#{bloqueioServicosBean.removerPesquisa}" style="margin-left: 10px" rendered="#{bloqueioServicosBean.pessoa.id != -1}" render="i_nome, b_remover, tbl" />
                            </h:panelGrid>
                            
                            <h:panelGrid columns="11" style="clear: both">
                                <h:selectOneMenu  value="#{bloqueioServicosBean.idServicos}">
                                    <a4j:ajax event="change" render="this"/>
                                    <f:selectItems value="#{bloqueioServicosBean.listaServico}" />
                                </h:selectOneMenu>
                                
                                <h:outputLabel value="Data Inicial" styleClass="fontePadrao" />
                                <h:inputText value="#{bloqueioServicosBean.refInicial}" class="referencia" size="5"/>
                                
                                <h:outputLabel value="Data Final" styleClass="fontePadrao" />
                                <h:inputText value="#{bloqueioServicosBean.refFinal}" class="referencia" size="5"/>
                                
                                <h:selectBooleanCheckbox id="chk_impressao" value="#{bloqueioServicosBean.bloqueia.impressao}">
                                    <a4j:ajax event="change" render="this"/>
                                </h:selectBooleanCheckbox>
                                <h:outputLabel value="Imprimir Guias" styleClass="fontePadrao" for="chk_impressao"/>
                                
                                <h:selectBooleanCheckbox id="chk_geracao" value="#{bloqueioServicosBean.bloqueia.geracao}">
                                    <a4j:ajax event="change" render="this"/>
                                </h:selectBooleanCheckbox>
                                <h:outputLabel value="Gerar Boletos" styleClass="fontePadrao" for="chk_geracao"/>
                                
                                <a4j:commandButton image="/Imagens/novo.png" action="#{bloqueioServicosBean.salvar}" title="Salvar este Bloqueio" render="i_msg tbl" disabled="#{controleAcessoBean.botaoSalvar}"/>
                            </h:panelGrid>
                        </div>
                        <br />
                        <h:outputLabel id="i_msg" value="#{bloqueioServicosBean.msgConfirma}" style="color: red; font-size: 13pt; clear: both; float: left"/>
                        <div style="overflow:auto; height:600px; width:1024px; clear: both; float: left">
                            <rich:dataTable onrowmouseover="this.style.backgroundColor='#F1F1F1'" onrowmouseout="this.style.backgroundColor='#FFFFFF'" value="#{bloqueioServicosBean.listaBloqueios}"
                                            var="linha" style="width: 100%" id="tbl" rows="20">
                                <rich:column styleClass="colunaPesquisa">
                                    <f:facet name="header"><h:outputText value="..."/></f:facet>
                                    <a4j:commandButton image="/Imagens/excluirp.png" action="#{bloqueioServicosBean.excluir(linha)}" render="i_msg tbl" disabled="#{controleAcessoBean.botaoExcluir}"/>
                                </rich:column>
                                
                                <rich:column>
                                    <f:facet name="header"><h:outputText value="ID"/></f:facet>
                                    <a4j:commandLink value="#{linha.id}" action="#{bloqueioServicosBean.editar(linha)}" styleClass="iLink" />
                                </rich:column>

                                <rich:column>
                                    <f:facet name="header"><h:outputText value="Serviço"/></f:facet>
                                    <h:outputText value="#{linha.servicos.descricao}"/>
                                </rich:column>

                                <rich:column>
                                    <f:facet name="header"><h:outputText value="Data Inicial"/></f:facet>
                                    <h:outputText value="#{linha.inicio}"/>
                                </rich:column>
                                
                                <rich:column>
                                    <f:facet name="header"><h:outputText value="Data Final"/></f:facet>
                                    <h:outputText value="#{linha.fim}"/>
                                </rich:column>
                                
                                <rich:column style="text-align: center">
                                    <f:facet name="header"><h:outputText value="Impressão de Guias"/></f:facet>
                                    
                                    <h:commandLink value="** IMPRIME **"     action="#{bloqueioServicosBean.alteraImprime(linha)}" title="Clique para mudar o Status" rendered="#{linha.impressao}"/>
                                    <h:commandLink value="** NÃO IMPRIME **" action="#{bloqueioServicosBean.alteraImprime(linha)}" title="Clique para mudar o Status" rendered="#{!linha.impressao}"/>
                                </rich:column>
                                
                                <rich:column style="text-align: center">
                                    <f:facet name="header"><h:outputText value="Geração de Guias"/></f:facet>
                                    <h:commandLink value="** GERA BOLETOS **" action="#{bloqueioServicosBean.alteraGera(linha)}" title="Clique para mudar o Status" rendered="#{linha.geracao}"/>
                                    <h:commandLink value="** NÃO GERA BOLETOS **" action="#{bloqueioServicosBean.alteraGera(linha)}" title="Clique para mudar o Status" rendered="#{!linha.geracao}"/>
                                </rich:column>
                            </rich:dataTable>
                        </div>    
                        
                    </div>
                </center>
                
            </h:form>
        </f:view>
    </h:body>
</ui:composition>