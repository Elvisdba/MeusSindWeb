-- SOCIOS -- 17/07/2013 -- CREATE OR REPLACE VIEW soc_socios_vw AS -- SELECT m.id_titular AS titular, p.id AS codsocio, p.ds_nome AS nome, pr.ds_parentesco AS parentesco, m.nr_matricula AS matricula, c.ds_categoria AS categoria, gc.ds_grupo_categoria AS grupo_categoria, m.dt_emissao AS filiacao, m.dt_inativo AS inativacao, c.votante, pr.ds_parentesco AS grau, se.nr_desconto, se.desconto_folha, tdoc.ds_descricao AS tipo_cobranca, tdoc.id AS cod_tipo_cobranca, c.id AS id_categoria, gc.id AS id_grupo_categoria, pr.id AS id_parentesco, s.id AS id_socio, s.nr_via_carteirinha AS nr_via, s.dt_validade_carteirinha AS validade_carteirinha--   FROM fin_servico_pessoa se--   JOIN pes_pessoa p ON p.id = se.id_pessoa--   JOIN soc_socios s ON s.id_servico_pessoa = se.id--   JOIN matr_socios m ON m.id = s.id_matricula_socios--   JOIN pes_pessoa t ON t.id = m.id_titular--   JOIN soc_parentesco pr ON pr.id = s.id_parentesco--   JOIN soc_categoria c ON c.id = m.id_categoria--   JOIN soc_grupo_categoria gc ON gc.id = c.id_grupo_categoria--   JOIN fin_tipo_documento tdoc ON tdoc.id = se.id_tipo_documento--  WHERE m.dt_inativo IS NULL AND (se.ds_ref_validade IS NULL OR se.ds_ref_validade::text = ''::text OR ((('28'::text || '/'::text) || se.ds_ref_validade::text)::timestamp without time zone) > now());CREATE INDEX chave  ON arr_mensagem_convencao  USING btree  (ds_referencia COLLATE pg_catalog."default", id_tipo_servico, id_convencao, id_servicos, id_grupo_cidade);CREATE INDEX chave_faturamento_folha_empresa  ON arr_faturamento_folha_empresa  USING btree  (id_juridica, id_tipo_servico, ds_referencia COLLATE pg_catalog."default");CREATE INDEX ref_faturamento_folha_empresa  ON arr_faturamento_folha_empresa  USING btree  (id_juridica, "substring"(ds_referencia::text, 4, 4) COLLATE pg_catalog."default", "substring"(ds_referencia::text, 1, 2) COLLATE pg_catalog."default", id_tipo_servico);CREATE INDEX indice_mensal_ano_mes  ON fin_indice_mensal  USING btree  (nr_mes, nr_ano);CREATE INDEX fin_baixa_ds_documento_baixa  ON fin_baixa  USING btree  (ds_documento_baixa);-- Index: id_desconto_empregadoCREATE INDEX id_desconto_empregado  ON arr_desconto_empregado  USING btree  (id);-- Index: id_serv_conv_gr_desconto_empregadoCREATE INDEX id_serv_conv_gr_desconto_empregado  ON arr_desconto_empregado  USING btree  (id_servicos, id_convencao, id_grupo_cidade);-- Index: id_serv_conv_gr_reff_desconto_empregadoCREATE INDEX id_serv_conv_gr_reff_desconto_empregado  ON arr_desconto_empregado  USING btree  (id_servicos, id_convencao, id_grupo_cidade, "substring"(ds_ref_final::text, 4, 4) COLLATE pg_catalog."default", "substring"(ds_ref_final::text, 1, 2) COLLATE pg_catalog."default");-- Index: id_serv_conv_gr_refi_desconto_empregadoCREATE INDEX id_serv_conv_gr_refi_desconto_empregado  ON arr_desconto_empregado  USING btree  (id_servicos, id_convencao, id_grupo_cidade, "substring"(ds_ref_inicial::text, 4, 4) COLLATE pg_catalog."default", "substring"(ds_ref_inicial::text, 1, 2) COLLATE pg_catalog."default");-- Index: id_faturamento_folha_empresaCREATE INDEX id_faturamento_folha_empresa  ON arr_faturamento_folha_empresa  USING btree  (id);-- Index: id_mensagem_convencaoCREATE INDEX id_mensagem_convencao  ON arr_mensagem_convencao  USING btree  (id);-- Index: id_mensagem_cobrancaCREATE INDEX id_mensagem_cobranca  ON fin_mensagem_cobranca  USING btree  (id);-- Index: id_mensagem_conv_mensagem_cobrancaCREATE INDEX id_mensagem_conv_mensagem_cobranca  ON fin_mensagem_cobranca  USING btree  (id_mensagem_convencao);-- Index: id_mov_mensagem_cobrancaCREATE INDEX id_mov_mensagem_cobranca  ON fin_mensagem_cobranca  USING btree  (id_movimento);-- Index: dt_baixaCREATE INDEX dt_baixa  ON fin_baixa  USING btree  (dt_baixa);-- Index: fin_baixa_ds_documento_baixaCREATE INDEX fin_baixa_ds_documento_baixa  ON fin_baixa  USING btree  (ds_documento_baixa COLLATE pg_catalog."default");-- Index: xid_baixaCREATE UNIQUE INDEX xid_baixa  ON fin_baixa  USING btree  (id);-- Index: xds_boleto_id_conta_cobranca_fin_boletoCREATE INDEX xds_boleto_id_conta_cobranca_fin_boleto  ON fin_boleto  USING btree  (ds_boleto COLLATE pg_catalog."default", id_conta_cobranca);-- Index: xnr_ctr_boleto_fin_boletoCREATE UNIQUE INDEX xnr_ctr_boleto_fin_boleto  ON fin_boleto  USING btree  (nr_ctr_boleto COLLATE pg_catalog."default");-- Index: xnr_ctr_boleto_is_ativo_fin_boletoCREATE INDEX xnr_ctr_boleto_is_ativo_fin_boleto  ON fin_boleto  USING btree  (nr_ctr_boleto COLLATE pg_catalog."default", is_ativo);-- Index: dt_vencimentoCREATE INDEX dt_vencimento  ON fin_movimento  USING btree  (dt_vencimento);-- Index: xds_doc_id_serv_movimento-- DROP INDEX xds_doc_id_serv_movimento;CREATE INDEX xds_doc_id_serv_movimento  ON fin_movimento  USING btree  (id_servicos, ds_documento COLLATE pg_catalog."default");-- Index: xid_acordo_movimento-- DROP INDEX xid_acordo_movimento;CREATE INDEX xid_acordo_movimento  ON fin_movimento  USING btree  (id_acordo);-- Index: xid_baixa_movimento-- DROP INDEX xid_baixa_movimento;CREATE INDEX xid_baixa_movimento  ON fin_movimento  USING btree  (id_baixa);-- Index: xid_lote_movimento-- DROP INDEX xid_lote_movimento;CREATE INDEX xid_lote_movimento  ON fin_movimento  USING btree  (id_lote);-- Index: xid_movimento-- DROP INDEX xid_movimento;CREATE UNIQUE INDEX xid_movimento  ON fin_movimento  USING btree  (id);-- Index: xnr_ctr_boleto-- DROP INDEX xnr_ctr_boleto;CREATE INDEX xnr_ctr_boleto  ON fin_movimento  USING btree  (nr_ctr_boleto COLLATE pg_catalog."default");-- Index: xid_pessoa-- DROP INDEX xid_pessoa;CREATE UNIQUE INDEX xid_pessoa  ON pes_pessoa  USING btree  (id);-- Index: xid_contabilidade_j-- DROP INDEX xid_contabilidade_j;CREATE INDEX xid_contabilidade_j  ON pes_juridica  USING btree  (id_contabilidade);-- Index: xid_juridica-- DROP INDEX xid_juridica;CREATE UNIQUE INDEX xid_juridica  ON pes_juridica  USING btree  (id);-- Index: xid_pessoa_j-- DROP INDEX xid_pessoa_j;CREATE INDEX xid_pessoa_j  ON pes_juridica  USING btree  (id_pessoa);-- Index: xid_juridica_dt_reaivacao-- DROP INDEX xid_juridica_dt_reaivacao;CREATE INDEX xid_juridica_dt_reaivacao  ON arr_contribuintes_inativos  USING btree  (id_juridica, dt_ativacao);-- Index: xid_juridica_rea-- DROP INDEX xid_juridica_rea;CREATE INDEX xid_juridica_rea  ON arr_contribuintes_inativos  USING btree  (id_juridica);-- Index: xid_abairro-- DROP INDEX xid_abairro;CREATE UNIQUE INDEX xid_abairro  ON end_bairro  USING btree  (id);-- Index: xid_cidade-- DROP INDEX xid_cidade;CREATE UNIQUE INDEX xid_cidade  ON end_cidade  USING btree  (id);-- Index: xid_descricao_endereco-- DROP INDEX xid_descricao_endereco;CREATE INDEX xid_descricao_endereco  ON end_descricao_endereco  USING btree  (id);-- Index: xds_cep-- DROP INDEX xds_cep;CREATE INDEX xds_cep  ON end_endereco  USING btree  (ds_cep COLLATE pg_catalog."default");-- Index: xid_bairro_endereco-- DROP INDEX xid_bairro_endereco;CREATE INDEX xid_bairro_endereco  ON end_endereco  USING btree  (id_bairro);-- Index: xid_cidade_endereco-- DROP INDEX xid_cidade_endereco;CREATE INDEX xid_cidade_endereco  ON end_endereco  USING btree  (id_cidade);-- Index: xid_descricao_endereco2-- DROP INDEX xid_descricao_endereco2;CREATE INDEX xid_descricao_endereco2  ON end_endereco  USING btree  (id_descricao_endereco);-- Index: xid_endereco-- DROP INDEX xid_endereco;CREATE UNIQUE INDEX xid_endereco  ON end_endereco  USING btree  (id);-- Index: fki_fin_lote_id_plano_5-- DROP INDEX fki_fin_lote_id_plano_5;CREATE INDEX fki_fin_lote_id_plano_5  ON fin_lote  USING btree  (id_plano_5);-- Index: xid_lote-- DROP INDEX xid_lote;CREATE UNIQUE INDEX xid_lote  ON fin_lote  USING btree  (id);-- Index: xid_pessoa_lote-- DROP INDEX xid_pessoa_lote;CREATE INDEX xid_pessoa_lote  ON fin_lote  USING btree  (id_pessoa);-- Index: xid_movimento_fin_historico-- DROP INDEX xid_movimento_fin_historico;CREATE INDEX xid_movimento_fin_historico  ON fin_historico  USING btree  (id_movimento);-- Index: soc_carteirinha_emissao_index-- DROP INDEX soc_carteirinha_emissao_index;CREATE INDEX soc_carteirinha_emissao_index  ON soc_carteirinha  USING btree  (dt_emissao);-- Index: soc_carteirinha_id_socio_index-- DROP INDEX soc_carteirinha_id_socio_index;CREATE INDEX soc_carteirinha_id_socio_index  ON soc_carteirinha  USING btree  (id_socio);-- Index: id_soc_socios-- DROP INDEX id_soc_socios;CREATE INDEX id_soc_socios  ON soc_socios  USING btree  (id);-- Index: soc_socios_id_matricula_socios-- DROP INDEX soc_socios_id_matricula_socios;CREATE INDEX soc_socios_id_matricula_socios  ON soc_socios  USING btree  (id_matricula_socios);-- Index: soc_socios_id_servico_pessoa-- DROP INDEX soc_socios_id_servico_pessoa;CREATE INDEX soc_socios_id_servico_pessoa  ON soc_socios  USING btree  (id_servico_pessoa);CREATE INDEX xid_cobranca_lote   ON fin_cobranca_lote (id ASC NULLS LAST);CREATE INDEX xid_cobranca   ON fin_cobranca (id ASC NULLS LAST);CREATE INDEX xid_cobranca_movimento   ON fin_cobranca (id ASC NULLS LAST, id_movimento ASC NULLS LAST);CREATE INDEX xid_cobranca   ON fin_cobranca (id ASC NULLS LAST);-- Index: ds_cep-- DROP INDEX ds_cep;CREATE INDEX ds_cep  ON end_endereco  USING btree  (ds_cep COLLATE pg_catalog."default");-- Index: id_endereco-- DROP INDEX id_endereco;CREATE INDEX id_endereco  ON end_endereco  USING btree  (id);CREATE INDEX pes_pessoa_ds_nome ON public.pes_pessoa  USING btree (ds_nome);CREATE INDEX id_pes_pessoa ON public.pes_pessoa  USING btree (id);CREATE INDEX id_pessoa_juridica ON public.pes_juridica  USING btree (id);CREATE INDEX indice_mensal_ano_mes ON public.fin_indice_mensal  USING btree (nr_mes, nr_ano);CREATE INDEX fin_indice_mensal_ano_mes ON public.fin_indice_mensal  USING btree (nr_ano, nr_mes);CREATE INDEX fin_baixa_ds_documento_baixa ON public.fin_baixa  USING btree (ds_documento_baixa);CREATE INDEX id_logradouro ON public.end_logradouro  USING btree (id);CREATE INDEX ds_logradouro ON public.end_logradouro  USING btree ((upper(translate((ds_descricao)::text, 'áéíóúàèìòùãõâêîôôäëïöüçÁÉÍÓÚÀÈÌÒÙÃÕÂÊÎÔÛÄËÏÖÜÇ*'::text, 'aeiouaeiouaoaeiooaeioucAEIOUAEIOUAOAEIOOAEIOUC'::text))));CREATE INDEX id_descricao_endereco ON public.end_descricao_endereco  USING btree (id);CREATE INDEX ds_descricao_endereco ON public.end_descricao_endereco  USING btree ((upper(translate((ds_descricao)::text, 'áéíóúàèìòùãõâêîôôäëïöüçÁÉÍÓÚÀÈÌÒÙÃÕÂÊÎÔÛÄËÏÖÜÇ*'::text, 'aeiouaeiouaoaeiooaeioucAEIOUAEIOUAOAEIOOAEIOUC'::text))));CREATE INDEX id_cidade ON public.end_cidade  USING btree (id);CREATE INDEX ds_cidade ON public.end_cidade  USING btree ((upper(translate((ds_cidade)::text, 'áéíóúàèìòùãõâêîôôäëïöüçÁÉÍÓÚÀÈÌÒÙÃÕÂÊÎÔÛÄËÏÖÜÇ*'::text, 'aeiouaeiouaoaeiooaeioucAEIOUAEIOUAOAEIOOAEIOUC'::text))));CREATE INDEX id_bairro ON public.end_bairro  USING btree (id);CREATE INDEX ds_bairro ON public.end_bairro  USING btree ((upper(translate((ds_descricao)::text, 'áéíóúàèìòùãõâêîôôäëïöüçÁÉÍÓÚÀÈÌÒÙÃÕÂÊÎÔÛÄËÏÖÜÇ*'::text, 'aeiouaeiouaoaeiooaeioucAEIOUAEIOUAOAEIOOAEIOUC'::text))));CREATE INDEX chave ON public.arr_mensagem_convencao  USING btree (ds_referencia, id_tipo_servico, id_convencao, id_servicos, id_grupo_cidade);CREATE INDEX chave_faturamento_folha_empresa ON public.arr_faturamento_folha_empresa  USING btree (id_juridica, id_tipo_servico, ds_referencia);CREATE INDEX chave_desconto_empregado ON public.arr_desconto_empregado  USING btree (id_convencao, id_grupo_cidade, id_servicos, ("substring"((ds_ref_inicial)::text, 4, 4)), ("substring"((ds_ref_inicial)::text, 1, 2)), ("substring"((ds_ref_final)::text, 4, 4)), ("substring"((ds_ref_final)::text, 1, 2)));