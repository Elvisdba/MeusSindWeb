<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui">

    <h:head>
        <title>Sindical - Cadastro Patronal</title>
        <meta http-equiv="X-UA-Compatible" content="IE=9" />
        <link rel="shortcut icon" href="#{facesContext.externalContext.requestContextPath}/Imagens/favicon.ico"/>  
        <style type="text/css">
            .ui-widget-content .ui-inputfield{ padding: 8px!important;} 
            .ui-button { padding: 3px!important; }            
        </style>
        
        <script type="text/javascript">
            
        </script>
        <meta http-equiv="X-UA-Compatible" content="IE=9" />
    </h:head>
    <h:body class="divMenu">
        <f:subview id="header">
            <ui:include src="templatePrime.xhtml"/>
        </f:subview>
        <f:view>
            <h:form rendered="#{controleAcessoBean.validacao}"></h:form>
            <p:panel styleClass="wrapper no-border">
                <h:form id="form_patronal">
                    <h:outputScript name="tradutor_primefaces.js" library="js" /> 
                    <p:growl id="growl" showDetail="true"/> 
                    <p:outputLabel value="Registro Patronal" styleClass="fonteHeader"/>
                    <c:set scope="request" var="object" value="${registroPatronalBean.patronal}"/>
                    <div class="clear"></div>
                    <p:panel id="id_panel_patronal">
                        <h:panelGrid columns="2">
                            <h:panelGrid columns="2" width="400" >
                                <p:commandButton id="idPesquisaPatronal" icon="ui-icon-search" action="#{chamadaPaginaBean.pesquisaPessoaJuridica}" immediate="true" title="Pesquisar Pessoa Jurídica"/>
                                <h:column>                                    
                                    <p:outputLabel value="PESQUISAR PESSOA JURÍDICA" style="border-bottom: 1px dashed gray; color: gray;" for="idPesquisaPatronal" rendered="#{registroPatronalBean.patronal.pessoa.id == -1}"/>
                                    <p:outputLabel value="#{registroPatronalBean.patronal.pessoa.nome}" for="idPesquisaPatronal" rendered="#{registroPatronalBean.patronal.pessoa.id != -1}"/>
                                </h:column>
                                <p:commandButton id="idPesquisaConvencao" icon="ui-icon-search" action="#{chamadaPaginaBean.pesquisaConvencao}" immediate="true" title="Pesquisar Convenção"/>
                                <h:column>
                                    <h:outputLabel styleClass="fontePadrao" value="Pesquisar Convenção" rendered="#{registroPatronalBean.patronal.convencao.id == -1}" for="idPesquisaConvencao"/>
                                    <h:outputText value="#{registroPatronalBean.patronal.convencao.descricao}" styleClass="fontePadraoNegrito" title="Pesquisa Convenção" style="border-bottom: 2px dashed white; height: 15px; padding-bottom: 5px;" rendered="#{registroPatronalBean.patronal.convencao.id != -1}"/>
                                </h:column>
                                <p:commandButton id="idPesquisaGrupoCidade" icon="ui-icon-search" action="#{chamadaPaginaBean.grupoCidade}" immediate="true" title="Pesquisar grupo cidade"/>
                                <h:column>
                                    <h:outputLabel styleClass="fontePadrao" value="Pesquisar Grupo Cidade" rendered="#{registroPatronalBean.patronal.grupoCidade.id == -1}" for="idPesquisaGrupoCidade"/>
                                    <h:outputText value="#{registroPatronalBean.patronal.grupoCidade.descricao}" styleClass="fontePadraoNegrito" title="Pesquisa Grupo Cidade" style="border-bottom: 2px dashed white; height: 15px; padding-bottom: 5px;" rendered="#{registroPatronalBean.patronal.grupoCidade.id != -1}" />
                                </h:column>
                            </h:panelGrid>
                            <p:panelGrid columns="1">
                                <p:commandButton value="Anexar arquivos" type="button" onclick="dgl_upload.show();" id="id_btn_uploads" rendered="#{registroPatronalBean.patronal.id != -1}"/>
                                <p:panel id="id_imagem_patronal" styleClass="no-border">
                                    <p:graphicImage value="/Cliente/#{controleUsuarioBean.clienteString}/Imagens/LogoPatronal/#{registroPatronalBean.logoPatronal}" width="150" style="float: right;" />
                                </p:panel>
                            </p:panelGrid>                            
                        </h:panelGrid>
                        <h:panelGrid columns="1" styleClass="margin-top-max">
                            <p:outputLabel styleClass="margin-top-max" value="Base territorial: " style="font-weight: bold;"/>
                            <p:inputTextarea value="#{registroPatronalBean.patronal.baseTerritorial}" title="Base territorial - Cidades que pertecem a esse registro patronal" cols="100" rows="3" styleClass="margin-top-max padding no-resize"/>                        
                        </h:panelGrid>
                        <h:panelGrid>
                            <h:outputLabel value="Lista cnaes" styleClass="fonteExtratoTela"/>
                            <h:panelGrid columns="3">
                                <p:commandButton icon="ui-icon-search" action="#{chamadaPaginaBean.pesquisaCnae}" title="Pesquisa Cnae"/>
                                <h:outputText value="#{registroPatronalBean.cnae.numero} - #{registroPatronalBean.cnae.cnae}" styleClass="fontePadraoNegrito" rendered="#{registroPatronalBean.cnae.id != -1}"/>
                                <p:commandButton icon="ui-icon-plus" action="#{registroPatronalBean.addCnae}" title="Adicionar um novo Cnae"  oncomplete="PF('dgl_panel_mensagem').show();" update="i_panel_mensagem id_patronal_cnaes" />
                            </h:panelGrid>
                        </h:panelGrid>
                        
                        <p:panel id="id_patronal_cnaes" styleClass="no-border no-margin">
                            <p:dataTable value="#{registroPatronalBean.listaPatronalCnae}" var="cnae" scrollable="true" scrollHeight="100" emptyMessage="Nenhum registro encontrado">
                                <p:column styleClass="text-center" headerText="Número">
                                    <h:outputText value="#{cnae.cnae.numero}" />
                                </p:column>
                                <p:column styleClass="text-center" headerText="Cnae">
                                    <f:facet name="header"><h:outputText value="Cnae"/></f:facet>
                                    <h:outputText value="#{cnae.cnae.cnae}" />
                                </p:column>                                
                                <p:column styleClass="text-center">
                                    <f:facet name="header"><h:outputText value="Excluir"/></f:facet>
                                    <p:commandButton icon="ui-icon-trash" action="#{registroPatronalBean.excluirCnae(cnae)}" style="cursor: pointer" title="Excluir cnae #{cnae.cnae.cnae}" update=":form_patronal:growl :form_patronal:id_patronal_cnaes"/>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                        <p:panelGrid columns="4" style="clear: both;" styleClass="margin-top-max sbb">
                            <p:column>
                                <p:commandButton value="Salvar" title="Salvar" onclick="dgl_panel_salvar.show()" disabled="#{controleAcessoBean.botaoSalvar}" type="button"/>
                                <p:commandButton value="Novo" title="Novo" action="#{registroPatronalBean.novo}" update="id_panel_patronal"/>
                                <p:commandButton value="Excluir" title="Excluir" onclick="dgl_panel_excluir.show()" disabled="#{controleAcessoBean.botaoExcluir}" type="button"/>
                                <p:commandButton value="Pesquisar" action="#{chamadaPaginaBean.pesquisaPatronal}" title="Pesquisar"/>
                            </p:column>
                        </p:panelGrid>
                    </p:panel>
                    <p:dialog id="i_panel_salvar" widgetVar="dgl_panel_salvar" modal="true" closable="true" width="300" header="Deseja salvar este registro?">
                        <p:panelGrid columns="2" styleClass="sbb">
                            <p:commandButton value="Sim" title="Salvar" action="#{registroPatronalBean.salvar()}" update="i_panel_mensagem id_panel_patronal"  oncomplete="PF('dgl_panel_mensagem').show(); PF('dgl_panel_salvar').hide();" />
                            <p:commandButton value="Não" title="Cancelar" onclick="dgl_panel_salvar.hide()"/>
                        </p:panelGrid>
                    </p:dialog>
                    <p:dialog id="i_panel_excluir" widgetVar="dgl_panel_excluir" modal="true" width="300" closable="true" header="Deseja excluir este registro?">
                        <center>
                            <p:panelGrid columns="2" styleClass="sbb">
                                <p:commandButton value="Sim" title="Excluir" action="#{registroPatronalBean.excluir()}" update="i_panel_mensagem id_panel_patronal" oncomplete="PF('dgl_panel_mensagem').show(); PF('dgl_panel_excluir').hide();"  />
                                <p:commandButton value="Não" title="Cancelar" onclick="dgl_panel_excluir.hide()"/>
                            </p:panelGrid>
                        </center>
                    </p:dialog>
                    <p:dialog id="i_panel_mensagem" modal="true" width="300" widgetVar="dgl_panel_mensagem" header="Mensagem">
                        <center>
                            <h:outputLabel value="#{registroPatronalBean.mensagem}" id="outConfirma"/>
                            <br /><br />
                            <p:commandButton value="Ok" title="Ok" oncomplete="PF('dgl_panel_mensagem').hide()"  />
                        </center>
                    </p:dialog>
                </h:form>
            </p:panel>
            <h:form id="form_patronal_upload" enctype="multipart/form-data" acceptcharset="UTF-8">
                <p:dialog id="id_dgl_anexos" widgetVar="dgl_upload" modal="true"  header="Anexar logo" closable="true">
                    <p:fileUpload label="Procurar"
                                  cancelLabel="Cancelar"
                                  uploadLabel="Anexar"
                                  mode="advanced"                                          
                                  dragDropSupport="true"
                                  multiple="false"
                                  update=":form_patronal:id_imagem_patronal"
                                  fileUploadListener="#{registroPatronalBean.upload}"
                                  oncomplete="PF('dgl_upload').hide()" />
                </p:dialog>
            </h:form>            
        </f:view>
    </h:body>
</ui:composition>
