<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:cc="http://java.sun.com/jsf/composite">

    <h:head>
        <title>Agenda Telefone</title>
        <meta http-equiv="X-UA-Compatible" content="IE=9" />
    </h:head>
    <h:body>
        <f:subview id="header">
            <ui:include src="templatePrime.xhtml"/>
        </f:subview>
        <f:view>
            <h:form id="formTemplate" rendered="#{controleAcessoBean.validacao}"></h:form>
            <p:panel styleClass="wrapper no-border">
                <h:form id="form_agenda_telefone">
                    <p:outputLabel value="Agenda Telefone" styleClass="fonteHeader"/>
                    <c:set scope="request" var="object" value="${agendaTelefoneBean.agendaTelefone}"/>
                    <div class="clear"></div>
                    <p:panel id="i_panel_acao" styleClass="fundoCinza" style="height: 50px">
                        <h:outputScript name="script_primefaces.js" library="js" />
                        <h:panelGrid columns="13" >
                            <p:commandButton value="Adicionar" id="id_click" update="i_panel_adicionar" action="#{agendaTelefoneBean.openDialog}" onclick="dgl_adicionar.show();" />
                            <p:outputLabel value="Pesquisar: " />
                            <p:selectOneMenu value="#{agendaTelefoneBean.idDDD}" id="idDDD" rendered="#{agendaTelefoneBean.porPesquisa.equals('telefone')}">
                                <p:ajax event="change" update="idDDD" />
                                <f:selectItems value="#{agendaTelefoneBean.listaDDD}" />
                            </p:selectOneMenu>
                            <p:inputText id="i_descricao" value="#{agendaTelefoneBean.descricaoPesquisa}" size="30" styleClass="#{agendaTelefoneBean.porPesquisa}"/>
                            <p:outputLabel value="Por: "/>
                            <p:selectOneMenu id="idTipoClasse" value="#{agendaTelefoneBean.porPesquisa}">
                                <p:ajax update="i_descricao, i_panel_acao" event="change" />
                                <f:selectItem itemValue="nome"      itemLabel="Nome" />
                                <f:selectItem itemValue="pessoa"    itemLabel="Pessoa" />
                                <f:selectItem itemValue="contato"   itemLabel="Contato" />
                                <f:selectItem itemValue="telefone"  itemLabel="Telefone" />
                                <f:selectItem itemValue="endereco"  itemLabel="Endereço" />
                            </p:selectOneMenu>
                            <p:commandButton id="idInicial" value="Inicial" action="#{agendaTelefoneBean.acaoPesquisaInicial}" update="id_lista"/>
                            <p:commandButton id="idParcial" value="Parcial" action="#{agendaTelefoneBean.acaoPesquisaParcial}" update="id_lista"/>
                            <h:outputLabel value="Grupo: " styleClass="fontePadrao" />
                            <p:selectOneMenu value="#{agendaTelefoneBean.idFiltroGrupoAgenda}">
                                <p:ajax event="change" update="id_lista" listener="#{agendaTelefoneBean.listaAgendas.clear()}" />
                                <f:selectItems value="#{agendaTelefoneBean.listaGrupoAgendas}" />
                            </p:selectOneMenu>
                            <p:selectBooleanCheckbox id="idFiltroGrupo" value="#{agendaTelefoneBean.filtraPorGrupo}" itemLabel="Filtrar" >
                                <p:ajax event="change" update="id_lista" listener="#{agendaTelefoneBean.listaAgendas.clear()}" />
                            </p:selectBooleanCheckbox>                            
                        </h:panelGrid>
                    </p:panel>
                    <p:panel styleClass="margin-top-max" id="id_lista" header="Contatos">
                        <p:dataTable value="#{agendaTelefoneBean.listaAgendas}" var="agendaTelefone" scrollable="true" scrollHeight="300" emptyMessage="Nenhum resultado encontrado" paginator="true" rows="15">
                            <p:column styleClass="text-center" width="25">
                                <p:commandButton icon="ui-icon-link" action="#{agendaTelefoneBean.editar(agendaTelefone.agenda)}"  />
                            </p:column>
                            <p:column styleClass="text-center" headerText="Grupo Agenda">
                                <p:commandLink action="#{agendaTelefoneBean.editar(agendaTelefone.agenda)}" value="#{agendaTelefone.agenda.grupoAgenda.descricao}"  style="text-transform: uppercase; "/>
                            </p:column>
                            <p:column styleClass="text-center" headerText="Nome">
                                <p:commandLink action="#{agendaTelefoneBean.editar(agendaTelefone.agenda)}" value="#{agendaTelefone.agenda.nome}"  style="text-transform: uppercase; " />
                            </p:column>
                            <p:column styleClass="text-center" headerText="Cidade / UF">
                                <p:commandLink action="#{agendaTelefoneBean.editar(agendaTelefone.agenda)}" value="#{agendaTelefone.agenda.endereco.cidade.cidade} - #{agendaTelefone.agenda.endereco.cidade.uf}"  style="text-transform: uppercase; " title="#{agendaTelefone.agenda.endereco.enderecoSimplesToString}" />
                            </p:column>
                            <p:column styleClass="text-center" headerText="Tipo Telefone">
                                <p:commandLink action="#{agendaTelefoneBean.editar(agendaTelefone.agenda)}" value="#{agendaTelefone.tipoTelefone.descricao}"  style="text-transform: uppercase; " />
                            </p:column>
                            <p:column styleClass="text-center" headerText="Telefone">
                                <p:commandLink action="#{agendaTelefoneBean.editar(agendaTelefone.agenda)}" value="+#{agendaTelefone.ddi} (#{agendaTelefone.ddd}) #{agendaTelefone.telefone}"  style="text-transform: uppercase; " />
                            </p:column>
                            <p:column styleClass="text-center" headerText="Contato">
                                <p:commandLink action="#{agendaTelefoneBean.editar(agendaTelefone.agenda)}" value="#{agendaTelefone.contato}"  style="text-transform: uppercase;" />
                            </p:column>
                        </p:dataTable>
                    </p:panel>
                    <p:dialog id="i_adicionar" widgetVar="dgl_adicionar" modal="true" header="Cadastro" width="1024" resizable="true"  maximizable="true" minimizable="true" onShow="true" visible="#{agendaTelefoneBean.visibility}">
                        <p:ajax event="close" update="out_mensagem i_panel_adicionar id_lista" listener="#{agendaTelefoneBean.close}"/>  
                        <p:panel id="i_panel_adicionar" styleClass="no-border">
                            <div>
                                <div style="float: left; width: 550px;">
                                    <p:panel>
                                        <h:panelGrid columns="2">
                                            <p:outputLabel value="Grupo Agenda: "  />
                                            <p:selectOneMenu value="#{agendaTelefoneBean.idGrupoAgenda}" id="grupoAgendaList" >
                                                <p:ajax event="change" update="grupoAgendaList" />
                                                <f:selectItems value="#{agendaTelefoneBean.listaGrupoAgendas}" />
                                            </p:selectOneMenu>
                                            <p:outputLabel value="Nome: "  />
                                            <p:inputText id="idNome" value="#{agendaTelefoneBean.agenda.nome}"  maxlength="100" size="35">
                                                <p:ajax event="change" update="idNome" /> 
                                            </p:inputText>
                                            <p:commandButton id="idPesquisaPessoa" icon="ui-icon-search"  action="#{chamadaPaginaBean.pesquisaPessoa}" immediate="true"/>
                                            <h:column>
                                                <p:outputLabel value="#{agendaTelefoneBean.pessoa.nome}" styleClass="fontePadraoNegrito"/>                            
                                                <p:outputLabel for="idPesquisaPessoa" value=" IMPORTAR PESSOA (Não Obrigatório)"  rendered="#{agendaTelefoneBean.pessoa.id == -1}" style="border-bottom: 2px #ffffff dashed;"/>
                                            </h:column>                            
                                            <p:commandButton id="idPesquisaEndereco" icon="ui-icon-search" title="Pesquisar Endereço"  action="#{chamadaPaginaBean.pesquisaEndereco}" immediate="true"/>
                                            <p:outputLabel for="idPesquisaEndereco" value="Pesquisar endereço" style="border-bottom: 2px #ffffff dashed;"/>
                                            <p:outputLabel value="Tipo Endereço: "  />
                                            <p:selectOneMenu id="idTpEnd" value="#{agendaTelefoneBean.idTipoEndereco}" disabled="#{agendaTelefoneBean.endereco.id == -1}" >
                                                <p:ajax event="change" update="idTpEnd" />
                                                <f:selectItems value="#{agendaTelefoneBean.listaTipoEnderecos}"/>
                                            </p:selectOneMenu>
                                            <p:outputLabel value="Endereço: "  />
                                            <h:column>
                                                <p:outputLabel value="#{agendaTelefoneBean.endereco.enderecoSimplesToString} - #{agendaTelefoneBean.endereco.cidade.cidade} / #{agendaTelefoneBean.endereco.cidade.uf}  "  rendered="#{agendaTelefoneBean.endereco.id != -1}" />
                                            </h:column>
                                            <p:outputLabel value="Número: " />
                                            <p:inputText value="#{agendaTelefoneBean.agenda.numero}"  maxlength="10" size="5" disabled="#{agendaTelefoneBean.endereco.id == -1}"/>
                                            <p:outputLabel value="Complemento: " />
                                            <p:inputText value="#{agendaTelefoneBean.agenda.complemento}"  maxlength="50" disabled="#{agendaTelefoneBean.endereco.id == -1}"/>
                                            <p:outputLabel value="Email 1: "  />
                                            <p:inputText value="#{agendaTelefoneBean.agenda.email1}"  maxlength="500" size="35"/>
                                            <p:outputLabel value="Email 2: "  />
                                            <p:inputText value="#{agendaTelefoneBean.agenda.email2}"  maxlength="500" size="35"/>
                                        </h:panelGrid>
                                    </p:panel>
                                    <p:panel header="Observações" styleClass="margin-top-max">
                                        <p:inputTextarea value="#{agendaTelefoneBean.agenda.observacao}" cols="100" rows="3" placeholder="Digite suas observações aqui"/>
                                    </p:panel>
                                    <div class="clear"></div>
                                    <h:panelGrid columns="4" styleClass="margin-top-max">
                                        <p:commandButton value="Salvar" onclick="dgl_panel_salvar.show()" disabled="#{controleAcessoBean.botaoSalvar}" />
                                        <p:commandButton value="Novo" action="#{agendaTelefoneBean.novo}" update="out_mensagem i_panel_adicionar id_lista"/>
                                        <p:commandButton value="Excluir" onclick="dgl_panel_excluir.show()"  disabled="#{controleAcessoBean.botaoExcluir}" />
                                        <p:commandButton value="Sair" action="#{agendaTelefoneBean.close}" update="out_mensagem i_panel_adicionar id_lista"/>
                                    </h:panelGrid>                                    
                                </div>
                                <div style="float: left; width: 400px;" class="margin-left-max">
                                    <c:if test="#{agendaTelefoneBean.agenda.id != -1}">
                                        <p:panel header="Telefone">
                                            <p:messages id="messages_telefone" showDetail="true" autoUpdate="true" closable="true"/>
                                            <h:panelGrid id="i_panel_cadastro_telefone">
                                                <p:row>
                                                    <h:outputScript name="script_primefaces.js" library="js" />
                                                </p:row>
                                                <p:row>
                                                    <p:column>
                                                        <h:panelGrid columns="7">
                                                            <p:selectOneMenu value="#{agendaTelefoneBean.idTipoTelefone}" >
                                                                <f:selectItems value="#{agendaTelefoneBean.listaTipoTelefones}"/>
                                                            </p:selectOneMenu>
                                                            <p:outputLabel value="+" />
                                                            <p:inputMask mask="99" value="#{agendaTelefoneBean.agendaTelefone.ddi}"  maxlength="2" size="1" title="DDI" style="text-align: center;"/>
                                                            <p:outputLabel value="("  />
                                                            <p:inputMask mask="99" value="#{agendaTelefoneBean.agendaTelefone.ddd}"  maxlength="2" size="1" title="DDD" style="text-align: center;"/>
                                                            <p:outputLabel value=")"  />
                                                            <p:inputText value="#{agendaTelefoneBean.agendaTelefone.telefone}" styleClass="telefone" maxlength="10" size="10" title="Telefone" />
                                                        </h:panelGrid>
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column>
                                                        <h:panelGrid columns="2">
                                                            <p:inputText value="#{agendaTelefoneBean.agendaTelefone.contato}"  maxlength="500" size="28" placeholder="Nome do contato"/>
                                                            <p:commandButton value="Adicionar" action="#{agendaTelefoneBean.adicionarAgendaTelefone()}" title="Adicionar/atualizar telefone" rendered="#{agendaTelefoneBean.agenda.id != -1}" disabled="#{controleAcessoBean.botaoSalvar}"  update="tbl_agenda_telefone messages_telefone" />                                                        
                                                        </h:panelGrid>
                                                    </p:column>
                                                </p:row>
                                            </h:panelGrid>
                                        </p:panel>
                                        <p:panel  id="tbl_agenda_telefone" styleClass="margin-top-max" header="Lista de telefones">
                                            <c:if test="#{agendaTelefoneBean.listaAgendaTelefones.size() > 0}">
                                                <p:dataTable var="telefone" value="#{agendaTelefoneBean.listaAgendaTelefones}">
                                                    <p:column headerText="Tipo">
                                                        <p:commandLink action="#{agendaTelefoneBean.editarAgendaTelefone(telefone)}" value="#{telefone.tipoTelefone.descricao}"  update=":form_agenda_telefone:tbl_agenda_telefone :form_agenda_telefone:i_panel_cadastro_telefone" />
                                                    </p:column>
                                                    <p:column headerText="Número">
                                                        <p:commandLink action="#{agendaTelefoneBean.editarAgendaTelefone(telefone)}" value="+#{telefone.ddi} (#{telefone.ddd}) #{telefone.telefone}"  update=":form_agenda_telefone:tbl_agenda_telefone :form_agenda_telefone:i_panel_cadastro_telefone" />
                                                    </p:column>
                                                    <p:column headerText="Contato">
                                                        <p:commandLink action="#{agendaTelefoneBean.editarAgendaTelefone(telefone)}" value="#{telefone.contato}"  update=":form_agenda_telefone:tbl_agenda_telefone :form_agenda_telefone:i_panel_cadastro_telefone" />
                                                    </p:column>
                                                    <p:column>
                                                        <p:commandButton icon="ui-icon-trash" action="#{agendaTelefoneBean.excluirAgendaTelefone(telefone)}" update=":form_agenda_telefone:tbl_agenda_telefone :form_agenda_telefone:i_panel_cadastro_telefone"/>
                                                    </p:column>                                    
                                                </p:dataTable>
                                            </c:if>
                                            <c:if test="#{agendaTelefoneBean.listaAgendaTelefones.size() == 0}">
                                                <f:facet name="header">
                                                    Lista de telefones - Nenhum telefone cadastrado!
                                                </f:facet> 
                                            </c:if>
                                        </p:panel>
                                    </c:if>
                                </div>
                            </div>
                        </p:panel>
                    </p:dialog>
                    <p:dialog id="i_panel_salvar" widgetVar="dgl_panel_salvar" modal="true" header="Deseja salvar este registro?" width="300">
                        <center>
                            <h:panelGrid columns="2">
                                <p:commandButton value="Sim" title="Salvar" action="#{agendaTelefoneBean.salvar}" update="i_panel_adicionar, out_mensagem, :form_agenda_telefone:id_lista" oncomplete="PF('dgl_panel_salvar').hide(); PF('dgl_panel_mensagem').show();"/>
                                <p:commandButton value="Não" title="Cancelar" onclick="dgl_panel_salvar.hide();"/>
                            </h:panelGrid>
                        </center>
                    </p:dialog>
                    <p:dialog id="i_panel_excluir" widgetVar="dgl_panel_excluir"  modal="true" resizable="true" header="Deseja excluir este registro?" width="300">
                        <center>
                            <h:panelGrid columns="2">
                                <p:commandButton value="Sim" title="Excluir" action="#{agendaTelefoneBean.excluir}" update="i_panel_adicionar, out_mensagem, :form_agenda_telefone:id_lista" oncomplete="PF('dgl_panel_excluir').hide(); PF('dgl_panel_mensagem').show();"/>
                                <p:commandButton value="Não" title="Cancelar" onclick="dgl_panel_excluir.hide();"/>
                            </h:panelGrid>
                        </center>
                    </p:dialog>                    
                    <p:dialog id="id_panel_mensagem" widgetVar="dgl_panel_mensagem" modal="true" header="Mensagem" width="300">
                        <center>
                            <h:panelGrid id="out_mensagem">
                                <p:outputLabel value="#{agendaTelefoneBean.mensagem}" />                            
                            </h:panelGrid> 
                            <p:commandButton value="Ok" title="Ok" onclick="dgl_panel_mensagem.hide();" />
                        </center>
                    </p:dialog>                    
                </h:form>                    
            </p:panel>                    
        </f:view>
    </h:body>
</ui:composition>